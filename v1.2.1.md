# <img src="./logo.png" alt="gas-fakes logo" width="50" align="top"> New Features: Cloud Logging and Upstash Integration

This document details two major new features in `gas-fakes`: direct integration with Google Cloud Logging and the ability to use Upstash Redis as a shared backend for `PropertiesService` and `CacheService`.

---

## Cloud Logging Integration

`gas-fakes` now fully emulates the native Google Apps Script `Logger.log()` integration with Google Cloud Logging. This allows you to send structured logs from your local Node.js development environment directly to your Google Cloud project, providing a unified logging experience for both local and live scripts.

### Configuration

Logging behavior is controlled by the `LOG_DESTINATION` environment variable in your `.env` file. You can set this value by running the interactive `setup.sh` script or by editing the file manually.

| `LOG_DESTINATION`   | Behavior                                                                                             |
| ------------------- | ---------------------------------------------------------------------------------------------------- |
| `CONSOLE` (Default) | Logs structured JSON to the local console (`stdout`).                                                  |
| `CLOUD`             | Sends logs directly to Google Cloud Logging. Nothing is written to the local console.                |
| `BOTH`              | Sends logs to both Google Cloud Logging and the local console.                                       |
| `NONE`              | Disables all output from `Logger.log()`.                                                             |

When logging to the cloud, entries are sent to the `gas-fakes/console_logs` log name and include the following labels for easy filtering in the Cloud Logging Log Explorer:
- `gas-fakes-scriptId`
- `gas-fakes-userId`

### Dynamic Control and Usage

You can also change the logging destination at any time during runtime by setting the `Logger.__logDestination` property.

**Example:**

```javascript
// Set in .env: LOG_DESTINATION="CLOUD"

// This log goes only to Google Cloud Logging
Logger.log('Initial log entry to the cloud.');

// Switch to logging to both destinations
Logger.__logDestination = 'BOTH';
Logger.log({ message: 'This entry goes to cloud and console', severity: 'WARNING' });

// You can get a direct link to the logs for the current session
console.log('Cloud Log Link for this session:', Logger.__cloudLogLink);
```

---

## Upstash Integration for Shared Data Stores

You can now configure `gas-fakes` to use Upstash Redis as a backend for `PropertiesService` and `CacheService`. This powerful feature allows you to share data between your local Node.js environment and a live Apps Script project, enabling true cross-environment integration testing. See [getting started](GETTING_STARTED.md) for more details on how


## <img src="./logo.png" alt="gas-fakes logo" width="50" align="top">  Further Reading

- [getting started](GETTING_STARTED.md) - how to handle authentication for restricted scopes.
- [readme](README.md)
- [initial idea and thoughts](https://ramblings.mcpher.com/a-proof-of-concept-implementation-of-apps-script-environment-on-node/)
- [Inside the volatile world of a Google Document](https://ramblings.mcpher.com/inside-the-volatile-world-of-a-google-document/)
- [Apps Script Services on Node – using apps script libraries](https://ramblings.mcpher.com/apps-script-services-on-node-using-apps-script-libraries/)
- [Apps Script environment on Node – more services](https://ramblings.mcpher.com/apps-script-environment-on-node-more-services/)
- [Turning async into synch on Node using workers](https://ramblings.mcpher.com/turning-async-into-synch-on-node-using-workers/)
- [All about Apps Script Enums and how to fake them](https://ramblings.mcpher.com/all-about-apps-script-enums-and-how-to-fake-them/)
- [Russian version](README.RU.md) ([credit Alex Ivanov](https://github.com/oshliaer)) - needs updating
- [colaborators](collaborators.md) - additional information for collaborators
- [oddities](oddities.md) - a collection of oddities uncovered during this project
- [gemini](gemini.md) - some reflections and experiences on using gemini to help code large projects
- [named colors](named-colors.md)
- [sandbox](sandbox.md)
- [named range identity](named-range-identity.md)
- [adc and restricted scopes](https://ramblings.mcpher.com/how-to-allow-access-to-sensitive-scopes-with-application-default-credentials/)
- [push test pull](pull-test-push.md)
- [gas fakes cli](gas-fakes-cli.md)
- [sharing cache and properties between gas-fakes and live apps script](https://ramblings.mcpher.com/sharing-cache-and-properties-between-gas-fakes-and-live-apps-script/)